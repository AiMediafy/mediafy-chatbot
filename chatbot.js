<invoke name="create_file">
<parameter name="description">Tworz nowy, zoptymalizowany plik chatbot.js kt贸ry zawiera zar贸wno HTML jak i JavaScript, aby kod w Framerze by ultra-kr贸tki</parameter>
<parameter name="path">/home/claude/chatbot.js</parameter>
<parameter name="file_text">// Mediafy Chatbot System - Wersja zewntrzna
(function(){const html=`<div id="sparta-root-container"><div class="sparta-welcome-badge" onclick="document.body.classList.add('show-widget');this.style.display='none';"><span class="material-symbols-outlined" style="font-size:18px;color:#F97316">sms</span>Przetestuj nasze rozwizanie RAG dla SPARTA</div><button class="chatbot-toggler"><span class="material-symbols-outlined">mode_comment</span><span class="material-symbols-outlined">close</span></button><div class="chatbot-widget"><header class="widget-header"><span class="material-symbols-outlined menu-icon">menu</span><div class="header-title"><h1>Asystent SPARTA</h1><span class="demo-badge">DEMO</span></div><div class="profile-icon">S</div></header><div class="settings-panel"><div style="display:flex;justify-content:space-between;color:#fff;border-bottom:1px solid #333;padding-bottom:10px"><h3>Kontakt</h3><span class="material-symbols-outlined close-panel-icon" style="cursor:pointer">close</span></div><div style="margin-top:20px;display:flex;flex-direction:column;gap:24px"><div style="display:flex;gap:16px"><div class="icon-box" style="width:40px;height:40px;background:#2c2c2e;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#F97316;flex-shrink:0"><span class="material-symbols-outlined">location_on</span></div><div><span style="color:#9da3ae;font-size:12px">Adres</span><br><span style="color:#fff;font-size:14px;line-height:1.5;display:block;margin-top:2px">SPARTA SP. Z O.O.<br>Bogucin, ul. Boczna 4<br>62-006 Kobylnica k/Poznania</span></div></div><div style="display:flex;gap:16px"><div class="icon-box" style="width:40px;height:40px;background:#2c2c2e;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#F97316;flex-shrink:0"><span class="material-symbols-outlined">schedule</span></div><div><span style="color:#9da3ae;font-size:12px">Godziny otwarcia</span><br><span style="color:#fff">pon-pt 8.00-17.00</span></div></div><div style="display:flex;gap:16px"><div class="icon-box" style="width:40px;height:40px;background:#2c2c2e;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#F97316;flex-shrink:0"><span class="material-symbols-outlined">call</span></div><div><span style="color:#9da3ae;font-size:12px">Telefon</span><br><a href="tel:+48618150086" style="color:#fff;text-decoration:none">+48 61 815 00 86</a></div></div><div style="display:flex;gap:16px"><div class="icon-box" style="width:40px;height:40px;background:#2c2c2e;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#F97316;flex-shrink:0"><span class="material-symbols-outlined">mail</span></div><div><span style="color:#9da3ae;font-size:12px">Email</span><br><a href="mailto:bok@sparta.com.pl" style="color:#fff;text-decoration:none">bok@sparta.com.pl</a></div></div></div></div><div class="cart-panel"><div style="display:flex;justify-content:space-between;color:#fff;border-bottom:1px solid #333;padding-bottom:10px"><h3>Koszyk</h3><span class="material-symbols-outlined close-cart" style="cursor:pointer">close</span></div><div class="cart-items-container"></div><div class="cart-footer"><div style="display:flex;justify-content:space-between;font-size:16px;font-weight:500"><span>Razem:</span><span class="total-price" style="color:#F97316;font-weight:700">0.00 z</span></div><button class="checkout-btn" style="width:100%;background:#F97316;color:#fff;border:none;padding:14px;border-radius:12px;margin-top:16px;cursor:pointer">Z贸偶 zam贸wienie</button></div></div><main class="widget-content"><div class="initial-content"><div class="welcome-text"><h2>Witaj! </h2><p>Pomog dobra tobie odpowiedni samozamykacz</p></div><div class="action-chips"><button class="chip" onclick="fillInput('sparta',this.innerText)">Jak dobra samozamykacz?</button><button class="chip" onclick="fillInput('sparta',this.innerText)">Potrzebuj samozamykacza</button><button class="chip" onclick="fillInput('sparta',this.innerText)">Godziny otwarcia firmy</button></div></div><ul class="chatbox"></ul></main><div class="bottom-input-area"><div class="input-container-dark"><textarea class="chat-input-field" data-bot-id="sparta" placeholder="Jaki samozamykacz Ci interesuje?" rows="1"></textarea><div class="input-controls-row"><button class="icon-btn-dark cart-trigger"><span class="material-symbols-outlined">shopping_cart</span><span class="cart-badge" style="display:none">0</span></button><div style="display:flex;gap:10px;align-items:center"><button class="pill-btn-outline" id="voice-btn-sparta"><span class="material-symbols-rounded">graphic_eq</span> M贸w</button><button class="send-btn" data-bot-id="sparta"><span class="material-symbols-rounded">send</span></button></div></div></div><div class="mediafy-footer"><span>Created by Mediafy</span></div></div><div class="custom-modal" id="delete-modal-sparta" style="display:none"><div class="modal-content" style="background:#2c2c2e;padding:24px;border-radius:20px;text-align:center;width:300px;border:1px solid #444"><span class="material-symbols-outlined" style="color:#facc15;font-size:40px;margin-bottom:10px">warning</span><h3 style="color:#fff;margin-bottom:8px">Usu produkt</h3><p style="color:#9da3ae;margin-bottom:20px">Czy na pewno chcesz usun ten produkt?</p><div style="display:flex;gap:10px"><button class="cancel-delete-btn" style="flex:1;background:transparent;border:1px solid #555;color:#fff;padding:10px;border-radius:50px;cursor:pointer">Anuluj</button><button class="confirm-delete-btn" style="flex:1;background:#ff4444;border:none;color:#fff;padding:10px;border-radius:50px;cursor:pointer">Usu</button></div></div></div></div></div><div id="mediafy-root-container"><div class="mediafy-welcome-badge" onclick="document.body.classList.add('show-mediafy-widget');this.style.display='none';"><span class="material-symbols-outlined" style="font-size:18px;color:#2563EB">auto_awesome</span>Masz pytania o ofert? Pisz miao! </div><button class="chatbot-toggler"><span class="material-symbols-outlined">psychology</span><span class="material-symbols-outlined">close</span></button><div class="chatbot-widget"><header class="widget-header"><span class="material-symbols-outlined menu-icon">menu</span><div class="header-title"><h1>Asystent Mediafy</h1><span class="demo-badge">AI</span></div><div class="profile-icon">M</div></header><div class="settings-panel"><div style="display:flex;justify-content:space-between;color:#fff;border-bottom:1px solid #333;padding-bottom:10px"><h3>Kontakt Mediafy</h3><span class="material-symbols-outlined close-panel-icon" style="cursor:pointer">close</span></div><div style="margin-top:20px;display:flex;flex-direction:column;gap:24px"><div style="display:flex;gap:16px"><div class="icon-box" style="width:40px;height:40px;background:#2c2c2e;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#2563EB;flex-shrink:0"><span class="material-symbols-outlined">schedule</span></div><div><span style="color:#9da3ae;font-size:12px">Godziny pracy</span><br><span style="color:#fff">pon-pt 8.00-16.00</span></div></div><div style="display:flex;gap:16px"><div class="icon-box" style="width:40px;height:40px;background:#2c2c2e;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#2563EB;flex-shrink:0"><span class="material-symbols-outlined">call</span></div><div><span style="color:#9da3ae;font-size:12px">Telefon</span><br><a href="tel:+48794027325" style="color:#fff;text-decoration:none">+48 794 027 325</a></div></div><div style="display:flex;gap:16px"><div class="icon-box" style="width:40px;height:40px;background:#2c2c2e;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#2563EB;flex-shrink:0"><span class="material-symbols-outlined">mail</span></div><div><span style="color:#9da3ae;font-size:12px">Email</span><br><a href="mailto:kontakt@mediafy.pl" style="color:#fff;text-decoration:none">kontakt@mediafy.pl</a></div></div></div></div><div class="cart-panel"><div style="display:flex;justify-content:space-between;color:#fff;border-bottom:1px solid #333;padding-bottom:10px"><h3>Usugi</h3><span class="material-symbols-outlined close-cart" style="cursor:pointer">close</span></div><div class="cart-items-container" style="justify-content:center;text-align:center"><p style="color:#9da3ae;padding-top:50px">Tutaj mo偶esz zobaczy list naszych usug.</p></div><div class="cart-footer"><button class="checkout-btn" style="width:100%;background:#2563EB;color:#fff;border:none;padding:14px;border-radius:12px;margin-top:0;cursor:pointer">Wylij zapytanie</button></div></div><main class="widget-content"><div class="initial-content"><div class="welcome-text"><h2>Cze! </h2><p>Jestem Asystentem Mediafy. W czym mog pom贸c?</p></div><div class="action-chips"><button class="chip" onclick="fillInput('mediafy',this.innerText)">Jak stworzy skuteczny Landing Page?</button><button class="chip" onclick="fillInput('mediafy',this.innerText)">Jakie s koszty stworzenia chatbota?</button><button class="chip" onclick="fillInput('mediafy',this.innerText)">Potrzebuj strony internetowej</button></div></div><ul class="chatbox"></ul></main><div class="bottom-input-area"><div class="input-container-dark"><textarea class="chat-input-field" data-bot-id="mediafy" placeholder="Napisz wiadomo..." rows="1"></textarea><div class="input-controls-row"><div style="flex:1"></div><div style="display:flex;gap:10px;align-items:center"><button class="pill-btn-outline" id="voice-btn-mediafy"><span class="material-symbols-rounded">graphic_eq</span> M贸w</button><button class="send-btn" data-bot-id="mediafy"><span class="material-symbols-rounded">send</span></button></div></div></div><div class="mediafy-footer"><span>Created by Mediafy</span></div></div><div class="custom-modal" id="delete-modal-mediafy" style="display:none"><div class="modal-content" style="background:#2c2c2e;padding:24px;border-radius:20px;text-align:center;width:300px;border:1px solid #444"><span class="material-symbols-outlined" style="color:#facc15;font-size:40px;margin-bottom:10px">warning</span><h3 style="color:#fff;margin-bottom:8px">Usu produkt</h3><p style="color:#9da3ae;margin-bottom:20px">Czy na pewno chcesz usun ten produkt?</p><div style="display:flex;gap:10px"><button class="cancel-delete-btn" style="flex:1;background:transparent;border:1px solid #555;color:#fff;padding:10px;border-radius:50px;cursor:pointer">Anuluj</button><button class="confirm-delete-btn" style="flex:1;background:#ff4444;border:none;color:#fff;padding:10px;border-radius:50px;cursor:pointer">Usu</button></div></div></div></div></div>`;document.body.insertAdjacentHTML('beforeend',html);const CONFIG={sparta:{API_URL:"https://mediafy-sparta.app.n8n.cloud/webhook/e93d888f-7641-4e5b-aff5-c39572adf088",CHAT_SESSION_ID:'sparta_demo_'+Math.random().toString(36).substring(2,9),ROOT_ID:'sparta-root-container',TOGGLE_CLASS:'show-widget'},mediafy:{API_URL:"https://mediafy-sparta.app.n8n.cloud/webhook/528387eb-c2b0-45e6-a38f-5bc06f7355f0",CHAT_SESSION_ID:'mediafy_demo_'+Math.random().toString(36).substring(2,9),ROOT_ID:'mediafy-root-container',TOGGLE_CLASS:'show-mediafy-widget'}};const sampleProducts=[{name:"Samozamykacz Geze TS 2000",price:189},{name:"Ramie standardowe TS 2000/4000",price:45}];document.addEventListener("DOMContentLoaded",()=>{initAllChatbots();initCart('sparta');initCart('mediafy')});setTimeout(initAllChatbots,200);window.fillInput=(t,x)=>{const c=CONFIG[t];if(!c)return;const r=document.getElementById(c.ROOT_ID);const i=r.querySelector(".chat-input-field");const s=r.querySelector(".send-btn");if(i&&s){i.value=x;s.click()}};function initCart(b){const r=document.getElementById(CONFIG[b].ROOT_ID);if(!r)return;const c=r.querySelector('.cart-items-container');const d=r.querySelector('.cart-badge');const t=r.querySelector('.total-price');if(c)c.innerHTML='';let o=0;const p=b==='sparta'?sampleProducts:[];const cl=b==='sparta'?'#F97316':'#2563EB';p.forEach(x=>{o+=x.price;const h=`<div class="cart-item"><div class="item-image"><span class="material-symbols-outlined">shopping_bag</span></div><div style="flex:1"><div style="font-size:14px;font-weight:500;color:#fff;margin-bottom:4px">${x.name}</div><div class="item-price" style="color:${cl}!important">${x.price.toFixed(2)} z</div></div><button class="icon-btn-dark delete-item" style="color:#ef4444;all:unset;cursor:pointer"><span class="material-symbols-outlined" style="font-size:20px">delete</span></button></div>`;if(c)c.innerHTML+=h});if(d){d.innerText=p.length;d.style.display=p.length>0?'flex':'none'}if(t)t.innerText=o.toFixed(2)+" z";if(r.querySelectorAll('.delete-item').length>0)r.querySelectorAll('.delete-item').forEach(x=>x.onclick=()=>r.querySelector(`#delete-modal-${b}`).style.display='flex');const m=r.querySelector(`#delete-modal-${b}`);if(m){const a=m.querySelector('.cancel-delete-btn');const f=m.querySelector('.confirm-delete-btn');if(a)a.onclick=()=>m.style.display='none';if(f)f.onclick=()=>{alert('Produkt usunity (DEMO).');m.style.display='none';initCart(b)}}}function resetBadge(b){const r=document.getElementById(CONFIG[b].ROOT_ID);if(!r)return;const d=r.querySelector(`.${b}-welcome-badge`);if(d){if(b==='sparta')d.innerHTML='<span class="material-symbols-outlined" style="font-size:18px;color:#F97316">sms</span> Przetestuj nasze rozwizanie RAG dla SPARTA';else if(b==='mediafy')d.innerHTML='<span class="material-symbols-outlined" style="font-size:18px;color:#2563EB">auto_awesome</span> Masz pytania o ofert? Pisz miao! ';d.style.display='flex'}}function initChatbot(b){const cfg=CONFIG[b];const r=document.getElementById(cfg.ROOT_ID);if(!r)return;const tg=r.querySelector(".chatbot-toggler");const bd=document.body;const inp=r.querySelector(".chat-input-field[data-bot-id='"+b+"']");const snd=r.querySelector(".send-btn[data-bot-id='"+b+"']");const cb=r.querySelector(".chatbox");const ic=r.querySelector(".initial-content");const vb=r.querySelector(`#voice-btn-${b}`);const ba=r.querySelector(".bottom-input-area");tg.onclick=()=>{const o=b==='sparta'?'mediafy':'sparta';bd.classList.remove(CONFIG[o].TOGGLE_CLASS);bd.classList.toggle(cfg.TOGGLE_CLASS);const s=document.querySelector("#sparta-root-container .sparta-welcome-badge");const m=document.querySelector("#mediafy-root-container .mediafy-welcome-badge");if(s)s.style.display='none';if(m)m.style.display='none'};const mb=r.querySelector(".menu-icon");const sp=r.querySelector(".settings-panel");const cp=r.querySelector(".close-panel-icon");const ct=r.querySelector(".cart-trigger");const ctp=r.querySelector(".cart-panel");const cc=r.querySelector(".close-cart");if(mb)mb.onclick=()=>{sp.classList.toggle("active");if(ctp)ctp.classList.remove("active");if(ba)ba.style.display="block"};if(cp)cp.onclick=()=>sp.classList.remove("active");if(ct)ct.onclick=()=>{ctp.classList.toggle("active");sp.classList.remove("active");if(ctp.classList.contains("active")){if(ba)ba.style.display="none"}else{if(ba)ba.style.display="block"}};if(cc)cc.onclick=()=>{ctp.classList.remove("active");if(ba)ba.style.display="block"};const createChatLi=(m,c)=>{const l=document.createElement("li");l.classList.add("chat-message",c);let h=c==="outgoing"?`<div class="message-text">${m}</div>`:`<div class="bot-icon">${b.charAt(0).toUpperCase()}</div><div class="message-text">${m}</div>`;if(m==="...")h=`<div class="bot-icon">${b.charAt(0).toUpperCase()}</div><div class="message-text loading-message" style="display:flex;align-items:center;width:50px"><span class="loading-dot" style="width:6px;height:6px;background:#9da3ae;border-radius:50%;margin:0 2px"></span><span class="loading-dot" style="width:6px;height:6px;background:#9da3ae;border-radius:50%;margin:0 2px"></span><span class="loading-dot" style="width:6px;height:6px;background:#9da3ae;border-radius:50%;margin:0 2px"></span></div>`;l.innerHTML=h;return l};const generateResponse=async(e,u)=>{const t=e.querySelector(".message-text");try{const res=await fetch(cfg.API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:u,sessionId:cfg.CHAT_SESSION_ID})});const d=await res.json();const br=d.message||d.output||d.text||JSON.stringify(d);const lc=b==='sparta'?'#F97316':'#2563EB';let f=br.replace(/\n[-\s]*\s/g,'\n').replace(/\n\n+/g,'\n\n').replace(/\[([^\]]*?)\]\s*\(([^)]+)\)/g,`<a href="$2" target="_blank" style="color:${lc};text-decoration:underline;font-weight:700;cursor:pointer">Kliknij tutaj</a>`).replace(/(?<!href="|">)(https?:\/\/[^\s<]+)/g,`<a href="$1" target="_blank" style="color:${lc};text-decoration:underline;font-weight:700;cursor:pointer">Kliknij tutaj</a>`);f=f.replace(/\n/g,'<br>').replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>');t.innerHTML=f}catch(x){t.textContent="Bd poczenia"}const sc=r.querySelector(".widget-content");sc.scrollTo({top:sc.scrollHeight,behavior:'smooth'});const lu=cb.querySelector(".chat-message.outgoing:last-of-type");if(lu)lu.scrollIntoView({behavior:"smooth",block:"start"})};const handleChat=()=>{const m=inp.value.trim();if(!m)return;ic.style.setProperty('display','none','important');cb.classList.add('active');inp.value="";cb.appendChild(createChatLi(m,"outgoing"));const l=createChatLi("...","incoming");cb.appendChild(l);const sc=r.querySelector(".widget-content");sc.scrollTo({top:sc.scrollHeight,behavior:'smooth'});generateResponse(l,m)};if(snd)snd.onclick=handleChat;if(inp)inp.onkeydown=e=>{if(e.key==="Enter"&&!e.shiftKey){e.preventDefault();handleChat()}};if('webkitSpeechRecognition'in window||'SpeechRecognition'in window){const SR=window.SpeechRecognition||window.webkitSpeechRecognition;const rec=new SR();rec.lang='pl-PL';rec.interimResults=false;if(vb){vb.onclick=()=>{if(vb.classList.contains("listening")){rec.stop();return}rec.start();vb.classList.add("listening");vb.innerHTML='<span class="material-symbols-rounded">mic</span> Sucham...'};rec.onresult=e=>{inp.value=e.results[0][0].transcript;vb.classList.remove("listening");vb.innerHTML='<span class="material-symbols-rounded">graphic_eq</span> M贸w';handleChat()};rec.onend=()=>{vb.classList.remove("listening");vb.innerHTML='<span class="material-symbols-rounded">graphic_eq</span> M贸w'}}}else{if(vb)vb.style.display='none'}}function initAllChatbots(){initChatbot('sparta');initChatbot('mediafy')}document.addEventListener('click',e=>{const sr=document.getElementById('sparta-root-container');const mr=document.getElementById('mediafy-root-container');const bd=document.body;const closeBot=i=>{const cfg=CONFIG[i];const r=document.getElementById(cfg.ROOT_ID);if(!r)return;bd.classList.remove(cfg.TOGGLE_CLASS);const d=r.querySelector(`.${i}-welcome-badge`);if(d){const c=i==='sparta'?'#F97316':'#2563EB';d.innerHTML=`<span class="material-symbols-outlined" style="font-size:18px;color:${c}">sms</span> Czekam na Twoje kolejne pytania! `;d.style.display='flex';setTimeout(()=>{const a=document.querySelectorAll('.sparta-welcome-badge, .mediafy-welcome-badge');a.forEach(x=>x.style.display='none');resetBadge(i)},3000)}};if(bd.classList.contains('show-widget')){const isIn=sr&&sr.contains(e.target);if(!isIn)closeBot('sparta')}if(bd.classList.contains('show-mediafy-widget')){const isIn=mr&&mr.contains(e.target);if(!isIn)closeBot('mediafy')}});})();
</parameter>
